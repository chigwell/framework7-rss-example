{"version":3,"sources":["framework7.feeds.js"],"names":["global","factory","exports","module","define","amd","Framework7Feeds","this","Feeds","name","install","Framework7Class","Class","app","params","call","Utils","utils","$","request","feeds","defaults","extend","on","view","$el","el","length","onFeedsLinkClick","e","preventDefault","index","data","open","items","onRefresh","refreshFeed","views","get","main","url","opened","attachEvents","parents","detachEvents","off","f7Feeds","init","__proto__","prototype","Object","create","constructor","formatDate","date","d","Date","split","getMonth","getDate","getFullYear","parseData","fragment","window","DOMParser","parseFromString","channel","find","newData","title","children","text","link","description","replace","copyright","image","width","height","each","item","itemData","pubDate","formattedDate","guid","customItemFields","childIndex","childEl","i","fieldName","fieldAttr","nodeName","getAttribute","push","loadFeed","refresh","emit","feedUrl","response","vlParams","virtualList","replaceAllItems","renderItem","renderVirtualListItem","html","renderList","ptr","done","trim","map","join","renderItemNavbar","openIn","renderItemPopup","renderPopup","renderItemPage","renderPage","onOpen","type","itemEl","$openedItemEl","openedItemEl","openedIn","onOpened","onClose","destroyed","onClosed","openPopup","popupParams","content","popupOpen","popup","popupOpened","popupClose","popupClosed","routableModals","router","navigate","route","path","modal","openPage","pageHtml","pageBeforeIn","page","pageAfterIn","pageBeforeOut","pageAfterOut","close","back","once","nextTick","destroy","deleteProps","pageBackLinkText","popupCloseLinkText","selector","pageInit","feedsEl","dataset","pageBeforeRemove"],"mappings":"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","file":"framework7.feeds.min.js","sourcesContent":["/**\n * Framework7 Plugin Feeds 2.0.0\n * Framework7 Feeds plugin brings easy RSS feeds integration into Framework7 app\n * http://framework7.io/plugins/\n *\n * Copyright 2014-2018 Vladimir Kharlampidi\n *\n * Released under the MIT License\n *\n * Released on: February 24, 2018\n */\n\n(function (global, factory) {\n\ttypeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() :\n\ttypeof define === 'function' && define.amd ? define(factory) :\n\t(global.Framework7Feeds = factory());\n}(this, (function () { 'use strict';\n\nvar FeedsClassConstructor = function (Framework7Class) {\n  return (function (Framework7Class) {\n    function Feeds(app, params) {\n      Framework7Class.call(this, params, [app]);\n\n      var Utils = app.utils;\n      var $ = app.$;\n      var request = app.request;\n\n      var feeds = this;\n      feeds.app = app;\n\n      var defaults = Utils.extend({\n        on: {},\n      }, app.params.feeds);\n\n      feeds.params = Utils.extend(defaults, params);\n\n      var $el = $(feeds.params.el);\n      if (!$el.length) { return feeds; }\n\n      var view;\n      if (feeds.params.view) {\n        view = feeds.params.view;\n      } else {\n        view = app.views.get($el);\n      }\n      if (!view) { view = app.views.main; }\n\n      Utils.extend(feeds, {\n        app: app,\n        request: request,\n        $el: $el,\n        el: $el[0],\n        view: view,\n        url: feeds.params.url,\n        data: {},\n        opened: false,\n      });\n\n\n      function onFeedsLinkClick(e) {\n        e.preventDefault();\n        var index = $(this).data('index');\n        feeds.open(feeds.data.items[index]);\n      }\n      function onRefresh() {\n        feeds.refreshFeed();\n      }\n\n      feeds.attachEvents = function attachEvents() {\n        feeds.$el.on('click', 'a.feeds-item-link', onFeedsLinkClick);\n        feeds.$el.parents('.ptr-content').on('ptr:refresh', onRefresh);\n      };\n      feeds.detachEvents = function detachEvents() {\n        feeds.$el.off('click', 'a.feeds-item-link', onFeedsLinkClick);\n        feeds.$el.parents('.ptr-content').off('ptr:refresh', onRefresh);\n      };\n\n      $el[0].f7Feeds = feeds;\n\n      feeds.init();\n\n      return feeds;\n    }\n\n    if ( Framework7Class ) Feeds.__proto__ = Framework7Class;\n    Feeds.prototype = Object.create( Framework7Class && Framework7Class.prototype );\n    Feeds.prototype.constructor = Feeds;\n    Feeds.prototype.formatDate = function formatDate (date) {\n      var feeds = this;\n      if (feeds.params.formatDate) { return feeds.params.formatDate.call(feeds, date); }\n\n      var d = new Date(date);\n      var months = ('Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec').split(' ');\n      return ((months[d.getMonth(d)]) + \" \" + (d.getDate(d)) + \", \" + (d.getFullYear()));\n    };\n    Feeds.prototype.parseData = function parseData (data) {\n      var feeds = this;\n      var $ = feeds.app.$;\n      var parser = new window.DOMParser();\n      var fragment = parser.parseFromString(data, 'text/xml');\n      var channel = $(fragment).find('rss > channel');\n      if (channel.length === 0) { return {}; }\n      var newData = {\n        title: channel.children('title').text(),\n        link: channel.children('link').text(),\n        description: channel.children('description').text().replace('<![CDATA[', '').replace(']]>', ''),\n        copyright: channel.children('copyright').text(),\n        image: {\n          url: channel.children('image').children('url').text(),\n          title: channel.children('image').children('title').text(),\n          link: channel.children('image').children('link').text(),\n          width: channel.children('image').children('width').text(),\n          height: channel.children('image').children('height').text(),\n        },\n        items: [],\n      };\n      var items = channel.find('item');\n      items.each(function (index, el) {\n        var item = $(el);\n        var itemData = {\n          title: item.children('title').text().replace('<![CDATA[', '').replace(']]>', ''),\n          link: item.children('link').text(),\n          description: item.children('description').text().replace('<![CDATA[', '').replace(']]>', ''),\n          pubDate: item.children('pubDate').text(),\n          formattedDate: feeds.formatDate(item.children('pubDate').text()),\n          guid: item.children('guid').text(),\n          index: newData.items.length,\n        };\n        if (feeds.params.customItemFields && feeds.params.customItemFields.length > 0) {\n          item.children().each(function (childIndex, childEl) {\n            for (var i = 0; i < feeds.params.customItemFields.length; i += 1) {\n              var fieldName = feeds.params.customItemFields[i].split('||')[0];\n              var fieldAttr = feeds.params.customItemFields[i].split('||')[1];\n              if (childEl.nodeName === fieldName) {\n                if (fieldAttr) { itemData[fieldName.replace(/:/g, '')] = childEl.getAttribute(fieldAttr); }\n                else { itemData[fieldName.replace(/:/g, '')] = $(childEl).text().replace('<![CDATA[', '').replace(']]>', ''); }\n              }\n            }\n          });\n        }\n        newData.items.push(itemData);\n      });\n\n      return newData;\n    };\n    Feeds.prototype.loadFeed = function loadFeed (refresh) {\n      var feeds = this;\n      var app = feeds.app;\n      feeds.emit('local::ajaxStart feedsAjaxStart', feeds);\n      feeds.request.get(feeds.params.feedUrl, function (response) {\n        feeds.emit('local::ajaxComplete feedsAjaxComplete', feeds, response);\n        feeds.data = feeds.parseData(response);\n        if (feeds.params.virtualList) {\n          if (refresh) {\n            feeds.virtualList.replaceAllItems(feeds.data.items);\n          } else {\n            var vlParams;\n            if (feeds.params.virtualList === 'true' || feeds.params.virtualList === true) {\n              vlParams = {};\n            } else {\n              vlParams = app.utils.extend({}, feeds.params.virtualList);\n            }\n            vlParams.el = feeds.el;\n            vlParams.items = feeds.data.items;\n            vlParams.renderItem = feeds.renderVirtualListItem;\n            feeds.$el.html('');\n            feeds.virtualList = app.virtualList.create(vlParams);\n          }\n        } else {\n          feeds.$el.html(feeds.renderList(feeds.data));\n        }\n\n        // Reset PTR\n        if (refresh) { app.ptr.done(feeds.$el.parents('.ptr-content')); }\n      });\n    };\n    Feeds.prototype.renderVirtualListItem = function renderVirtualListItem (item, index) {\n      var feeds = this;\n      if (feeds.params.renderVirtualListItem) { return feeds.params.renderVirtualListItem.call(feeds, item, index); }\n\n      var itemHtml = \"\\n        <li>\\n          <a href=\\\"#\\\" class=\\\"item-link item-content feeds-item-link\\\" data-index=\\\"\" + index + \"\\\">\\n            <div class=\\\"item-inner\\\">\\n              <div class=\\\"item-title\\\">\" + (item.title) + \"</div>\\n              <div class=\\\"item-after\\\">\" + (item.formattedDate) + \"</div>\\n            </div>\\n          </a>\\n        </li>\\n      \";\n\n      return itemHtml.trim();\n    };\n    Feeds.prototype.renderList = function renderList (data) {\n      var feeds = this;\n      if (feeds.params.renderList) { return feeds.params.renderList.call(feeds, data); }\n\n      var listHtml = \"\\n        <ul>\\n          \" + (data.items.map(function (item, index) { return (\"\\n            <li>\\n              <a href=\\\"#\\\" class=\\\"item-link item-content feeds-item-link\\\" data-index=\\\"\" + index + \"\\\">\\n                <div class=\\\"item-inner\\\">\\n                  <div class=\\\"item-title\\\">\" + (item.title) + \"</div>\\n                  <div class=\\\"item-after\\\">\" + (item.formattedDate) + \"</div>\\n                </div>\\n              </a>\\n            </li>\\n          \"); }).join('')) + \"\\n        </ul>\\n      \";\n      return listHtml.trim();\n    };\n    Feeds.prototype.renderItemNavbar = function renderItemNavbar (item) {\n      var feeds = this;\n      if (feeds.params.renderItemNavbar) { return feeds.params.renderItemNavbar.call(feeds, item); }\n\n      var navbarHtml = \"\\n        <div class=\\\"navbar\\\">\\n          <div class=\\\"navbar-inner sliding\\\">\\n            \" + (feeds.params.openIn === 'page' ? (\"\\n            <div class=\\\"left\\\">\\n              <a href=\\\"#\\\" class=\\\"link back\\\">\\n                <i class=\\\"icon icon-back\\\"></i>\\n                <span class=\\\"ios-only\\\">\" + (feeds.params.pageBackLinkText) + \"</span>\\n              </a>\\n            </div>\\n            \") : '') + \"\\n            <div class=\\\"title\\\">\" + (item.title) + \"</div>\\n            \" + (feeds.params.openIn === 'popup' ? (\"\\n            <div class=\\\"right\\\">\\n              <a href=\\\"#\\\" class=\\\"link popup-close\\\" data-popup=\\\".feeds-popup\\\">\" + (feeds.params.popupCloseLinkText) + \"</a>\\n            </div>\\n            \") : '') + \"\\n          </div>\\n        </div>\\n      \";\n\n      return navbarHtml.trim();\n    };\n    Feeds.prototype.renderItemPopup = function renderItemPopup (item) {\n      var feeds = this;\n      if (feeds.params.renderPopup) { return feeds.params.renderPopup.call(feeds, item); }\n\n      var popupHtml = \"\\n        <div class=\\\"popup feeds-popup\\\">\\n          <div class=\\\"view view-init\\\">\\n            \" + (feeds.renderItemPage(item)) + \"\\n          </div>\\n        </div>\\n      \";\n\n      return popupHtml.trim();\n    };\n    Feeds.prototype.renderItemPage = function renderItemPage (item) {\n      var feeds = this;\n      if (feeds.params.renderPage) { return feeds.params.renderPage.call(feeds, item); }\n\n      var pageHtml = \"\\n        <div class=\\\"page feeds-page\\\" data-page=\\\"feeds-page-\" + (item.index) + \"\\\">\\n          \" + (feeds.renderItemNavbar(item)) + \"\\n          <div class=\\\"page-content\\\">\\n            <div class=\\\"block\\\">\\n              <a href=\\\"\" + (item.link) + \"\\\" class=\\\"external\\\" target=\\\"_blank\\\">\" + (item.title) + \"</a><br>\\n              <small>\" + (item.formattedDate) + \"</small>\\n            </div>\\n            <div class=\\\"block block-strong\\\">\" + (item.description) + \"</div>\\n          </div>\\n        </div>\\n      \";\n\n      return pageHtml.trim();\n    };\n    Feeds.prototype.refreshFeed = function refreshFeed () {\n      var feeds = this;\n      return feeds.loadFeed(true);\n    };\n    Feeds.prototype.onOpen = function onOpen (type, itemEl) {\n      var feeds = this;\n      var app = feeds.app;\n      var $openedItemEl = app.$(itemEl);\n      feeds.$openedItemEl = $openedItemEl;\n      feeds.openedItemEl = $openedItemEl[0];\n      feeds.openedIn = type;\n      feeds.opened = true;\n\n      feeds.emit('local::open feedsOpen', feeds);\n    };\n    Feeds.prototype.onOpened = function onOpened () {\n      var feeds = this;\n      feeds.emit('local::opened feedsOpened', feeds);\n    };\n    Feeds.prototype.onClose = function onClose () {\n      var feeds = this;\n      if (feeds.destroyed) { return; }\n      feeds.emit('local::close feedsClose', feeds);\n    };\n    Feeds.prototype.onClosed = function onClosed () {\n      var feeds = this;\n      if (feeds.destroyed) { return; }\n      feeds.opened = false;\n      feeds.$openedItemEl = null;\n      feeds.openedItemEl = null;\n      delete feeds.$openedItemEl;\n      delete feeds.openedItemEl;\n\n      feeds.emit('local::closed feedsClosed', feeds);\n    };\n    Feeds.prototype.openPopup = function openPopup (item) {\n      var feeds = this;\n      if (feeds.opened) { return feeds; }\n      var popupHtml = feeds.renderItemPopup(item);\n      var popupParams = {\n        content: popupHtml,\n        on: {\n          popupOpen: function popupOpen(popup) {\n            feeds.onOpen('popup', popup.el);\n          },\n          popupOpened: function popupOpened(popup) {\n            feeds.onOpened('popup', popup.el);\n          },\n          popupClose: function popupClose(popup) {\n            feeds.onClose('popup', popup.el);\n          },\n          popupClosed: function popupClosed(popup) {\n            feeds.onClosed('popup', popup.el);\n          },\n        },\n      };\n\n      if (feeds.params.routableModals) {\n        feeds.view.router.navigate({\n          url: feeds.url,\n          route: {\n            path: feeds.url,\n            popup: popupParams,\n          },\n        });\n      } else {\n        feeds.modal = feeds.app.popup.create(popupParams).open();\n      }\n      return feeds;\n    };\n    Feeds.prototype.openPage = function openPage (item) {\n      var feeds = this;\n      if (feeds.opened) { return feeds; }\n      var pageHtml = feeds.renderItemPage(item);\n      feeds.view.router.navigate({\n        url: feeds.url,\n        route: {\n          content: pageHtml,\n          path: feeds.url,\n          on: {\n            pageBeforeIn: function pageBeforeIn(e, page) {\n              feeds.onOpen('page', page.el);\n            },\n            pageAfterIn: function pageAfterIn(e, page) {\n              feeds.onOpened('page', page.el);\n            },\n            pageBeforeOut: function pageBeforeOut(e, page) {\n              feeds.onClose('page', page.el);\n            },\n            pageAfterOut: function pageAfterOut(e, page) {\n              feeds.onClosed('page', page.el);\n            },\n          },\n        },\n      });\n      return feeds;\n    };\n    Feeds.prototype.open = function open (item) {\n      var feeds = this;\n      if (feeds.opened) { return feeds; }\n      if (feeds.params.openIn === 'popup') {\n        return feeds.openPopup(item);\n      }\n      return feeds.openPage(item);\n    };\n    Feeds.prototype.close = function close () {\n      var feeds = this;\n      if (!feeds.opened) { return feeds; }\n      if (feeds.params.routableModals || feeds.openedIn === 'page') {\n        feeds.view.router.back();\n      } else {\n        feeds.modal.once('modalClosed', function () {\n          feeds.app.utils.nextTick(function () {\n            feeds.modal.destroy();\n            delete feeds.modal;\n          });\n        });\n        feeds.modal.close();\n      }\n      return feeds;\n    };\n\n    Feeds.prototype.init = function init () {\n      var feeds = this;\n      feeds.loadFeed();\n      feeds.attachEvents();\n    };\n    Feeds.prototype.destroy = function destroy () {\n      var feeds = this;\n      feeds.emit('local::beforeDestroy feedsBeforeDestroy', feeds);\n      feeds.detachEvents();\n\n      if (feeds.virtualList && feeds.virtualList.destroy) {\n        feeds.virtualList.destroy();\n      }\n\n      delete feeds.$el[0].f7Feeds;\n      feeds.app.utils.deleteProps(feeds);\n      feeds.destroyed = true;\n    };\n\n    return Feeds;\n  }(Framework7Class));\n};\n\nvar Feeds;\n\nvar framework7_feeds = {\n  name: 'feeds',\n  install: function install() {\n    var Framework7 = this;\n    Feeds = FeedsClassConstructor(Framework7.Class);\n    Framework7.Feeds = Feeds;\n  },\n  params: {\n    feeds: {\n      openIn: 'page',\n      url: 'feed/',\n      routableModals: true,\n      view: null,\n      feedUrl: null,\n      formatDate: null,\n      customItemFields: [],\n      virtualList: false,\n      pageBackLinkText: 'Back',\n      popupCloseLinkText: 'Close',\n      renderList: null,\n      renderVirtualListItem: null,\n      renderItemPage: null,\n      renderItemPopup: null,\n    },\n  },\n  create: function create() {\n    var app = this;\n    app.feeds = {\n      create: function create(params) {\n        return new Feeds(app, params);\n      },\n      get: function get(selector) {\n        if (selector instanceof Feeds) { return selector; }\n        var $el = app.$(selector);\n        if ($el.length > 0 && $el[0] && $el[0].f7Feeds) {\n          return $el[0].f7Feeds;\n        }\n        return undefined;\n      },\n      destroy: function destroy(selector) {\n        if (selector instanceof Feeds) {\n          if (selector.destroy) { selector.destroy(); }\n          return;\n        }\n        var $el = app.$(selector);\n        if (!$el.length) { return; }\n        if ($el[0] && $el[0].f7Feeds && $el[0].f7Feeds.destroy) {\n          $el[0].f7Feeds.destroy();\n        }\n      },\n    };\n  },\n  on: {\n    pageInit: function pageInit(page) {\n      var app = page.app;\n      var $ = app.$;\n      var Utils = app.utils;\n      page.$el.find('.feeds-init').each(function (index, feedsEl) {\n        var $el = $(feedsEl);\n        app.feeds.create(Utils.extend(\n          { el: feedsEl },\n          $el.dataset()\n        ));\n      });\n    },\n    pageBeforeRemove: function pageBeforeRemove(page) {\n      var app = page.app;\n      page.$el.find('.feeds-init').each(function (index, feedsEl) {\n        app.feeds.destroy(feedsEl);\n      });\n    },\n  },\n};\n\nreturn framework7_feeds;\n\n})));\n"]}